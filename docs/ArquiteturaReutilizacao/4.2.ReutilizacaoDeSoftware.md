# 4.2. Módulo Reutilização de Software

## Introdução

A reutilização de software é um conceito amplamente utilizado que pode ser definido de várias maneiras. Em geral, refere-se ao aproveitamento de informações, componentes de software ou sistemas já existentes por um desenvolvedor na criação de novos sistemas. Este documento visa destacar exemplos e práticas onde essa abordagem foi aplicada efetivamente.

## Pacote de Avaliação por Estrelas do React

Em muitas aplicações da atualidade é necessario permitir aos usuários fornecer feedback através de uma interface de avaliação por estrelas e também exibir essa informaçao ao usuario. Para isso o pacote **React Stars** oferece um componente de avaliação por estrelas fácil de integrar e personalizar.

### Aplicações no projeto

Na nossa aplicação um dos locais onde o **React Stars** pode ser utilizado foi para exibir a avaliação que um jogo possui. Abaixo estão os trechos de código e interface pertinentes:

<details>
    <summary>Implementação em código - React Stars</summary>

![reutilizacao](../assets/reutilizacao/reactStarsCodigo1.png)

![reutilizacao](../assets/reutilizacao/reactStarsCodigo2.png)

O codigo em questão pode ser encontrado na integra em [/app/myecommerce/src/app/jogos/[id]/page.tsx](https://github.com/UnBArqDsw2024-1/2024.1_G1_My_Ecommerce/blob/main/app/myecommerce/src/app/jogos/%5Bid%5D/page.tsx)

</details>

<details>
    <summary>Visualização na interface - React Stars</summary>

![reutilizacao](../assets/reutilizacao/reactStarsInterface.png)

</details>

## Tailwind

Tailwind CSS é um framework de CSS utilitário que permite aplicar estilos diretamente no HTML usando classes pré-definidas, o que torna o desenvolvimento mais rápido e eficiente.  Ele foi escolhido devido a sua reutilização de código, promovendo consistência ao usar as mesmas classes em diferentes partes do projeto, simplificando a manutenção ao evitar a criação de novas regras CSS, e reduzindo o código duplicado, resultando em um código mais limpo e reutilizável.

## Prisma

![prisma](../assets/reutilizacao/prisma-2.svg)

### Conceito

Prisma é um framework ORM para NodeJS que, além de mapear as entidades de um banco de dados, auxilia, facilita e oferece mais segurança no desenvolvimento. Foram utilizados os construtores de consulta por meio do Prisma Client, os quais permitem a modificação das models no schema de forma mais flexível. Também foram feitas, de forma mais rígida, as declarações de modelagem e migração de dados para SQLite, com o uso do Prisma Migrate, além da visualização rápida e edição do banco por meio do Prisma Studio. No contexto de REST APIs, também foram geradas consultas ao banco na controladora de rotas, associada a outro framework, o Express. Assim, foi permitida a reutilização de software de forma mais ágil.

![prisma1](../assets/reutilizacao/prisma1.png)
![prisma1](../assets/reutilizacao/prisma2.png)

### Características

- **Reutilizável**: Bem documentado e compreensível;
- **Extensível**: Capaz de ser especializado para diferentes aplicações, NodeJs e Typescript principalmente;
- **Seguro**: Com princípios como encapsulamento bem implementados;
- **Tipo**: Considerado caixa cinza por ser híbrido, oferecendo ferramentas mais flexíveis (caixa branca) e mais rígidas (caixa preta);
- **Empacotamento**: Pacote NPM (Node Package Manager), que pode ser facilmente adicionado a qualquer projeto Node.js.

### Código

<details>
    <summary>Definição das models</summary>

`aap/backend/prisma/schema.prisma`

    generator client {
    provider = "prisma-client-js"
    }

    datasource db {
    provider = "sqlite"
    url      = env("DATABASE_URL")
    }

    model Genero {
    @@map("generos")
    idGenero Int @id @default(autoincrement())
    nomeGenero String @unique
    GeneroJogo GeneroJogo[]
    }

    model Editora {
    @@map("editoras")
    idEditora Int @id @default(autoincrement())
    nomeEditora String @unique
    Jogo Jogo[]
    }

    model Desenvolvedora {
    @@map("desenvolvedoras")
    idDesenvolvedora Int @id @default(autoincrement())
    nomeDesenvolvedora String @unique
    Jogo Jogo[]
    }

    model Recurso {
    @@map("recursos")
    idRecurso Int @id @default(autoincrement())
    nomeRecurso String @unique
    RecursoJogo RecursoJogo[]
    }

    model Tipo {
    @@map("tipo")
    idTipo Int @id @default(autoincrement())
    nomeTipo String @unique
    TipoJogo TipoJogo[]
    }

    model Jogo {
    @@map("jogos")
    idJogo String @id @default(uuid())
    nomeJogo String 
    precoJogo Float
    descricao String
    dataLancamento DateTime
    dataLancamentoInicial DateTime
    desconto Float
    quantidadeVendido Int
    editora Editora?  @relation(fields: [editoraId], references: [idEditora])
    editoraId Int?
    desenvolvedora Desenvolvedora? @relation(fields: [desenvolvedoraId], references: [idDesenvolvedora])
    desenvolvedoraId Int?
    plataforma String
    imagemCaminho String 
    Pedidos Pedido[]
    RecursoJogo RecursoJogo[]
    GeneroJogo GeneroJogo[]
    TipoJogo TipoJogo[]
    }

    model TipoJogo {
    idJogo    String
    idTipo Int
    jogo      Jogo    @relation(fields: [idJogo], references: [idJogo])
    tipo   Tipo @relation(fields: [idTipo], references: [idTipo])

    @@id([idJogo, idTipo])
    }

    model RecursoJogo {
    idJogo    String
    idRecurso Int
    jogo      Jogo    @relation(fields: [idJogo], references: [idJogo])
    recurso   Recurso @relation(fields: [idRecurso], references: [idRecurso])

    @@id([idJogo, idRecurso])
    }

    model GeneroJogo {
    idJogo    String
    idGenero Int
    jogo      Jogo    @relation(fields: [idJogo], references: [idJogo])
    genero   Genero @relation(fields: [idGenero], references: [idGenero])

    @@id([idJogo, idGenero])
    }

    model Pais {
    idPais Int @id @default(autoincrement())
    nomePais String @unique
    Cliente Cliente[]
    }

    model Cliente {
    @@map("clientes")
    idCliente String @id @default(uuid())
    nomeExibicao String @unique
    dataNascimento DateTime
    nome String
    email String @unique
    senha String
    pais Pais? @relation(fields: [paisId], references: [idPais])
    paisId Int?
    Pedidos Pedido[]
    }

    model Pedido {
    idPedido Int @id @default(autoincrement())
    status String
    dataPedido DateTime
    notaFiscal     String?
    Cliente Cliente @relation(fields: [clienteId], references: [idCliente])
    clienteId String
    Jogo Jogo @relation(fields: [jogoId], references: [idJogo])
    jogoId String 
    FormaPagamento FormaPagamento? @relation(fields: [formaPagamentoId], references: [idFormaPagamento])
    formaPagamentoId String? // Adiciona o campo de chave estrangeira
    }

    model FormaPagamento {
        idFormaPagamento  String   @id @default(uuid())
        dataVencimento DateTime
        pagamentoConfirmado Boolean
        tipo           String?
        numeroCartao   String?  
        titular        String?  
        cvc            String?  
        validade       String?  
        codigoBoleto   String?  
        chavePix       String? 
        Pedido         Pedido[] 
    }

</details>
<details>
    <summary>Consultas</summary>

`app/backend/src/Modelo/repositorio/jogo.repositorio.ts`

    ...

    public async pesquisarPorNome(nomeJogo: string): Promise<Jogo[]> {
            // Buscar todos os jogos que correspondem ao nome fornecido, insensível a maiúsculas e minúsculas
            const aJogos = await this.prisma.jogo.findMany({
                where: { nomeJogo: { contains: nomeJogo }},
                include: {
                    editora: { select: { nomeEditora: true } },
                    desenvolvedora: { select: { nomeDesenvolvedora: true } },
                    RecursoJogo: {
                        include: {
                            recurso: { select: { nomeRecurso: true } }
                        }
                    },
                    GeneroJogo: {
                        include: {
                            genero: { select: { nomeGenero: true } }
                        }
                    },
                    TipoJogo: {
                        include: {
                            tipo: { select: { nomeTipo: true } }
                        }
                    }
                }
            });

    ...

`app/backend/src/api/express/controladora/jogo.controladora.ts`

    ...

    public async lista(request: Request, response: Response) {
        try {
            const jogoRepositorio = JogoRepositorioPrisma.build(prisma);
            const jogoServico = JogoServicoImplementacao.build(jogoRepositorio);

            const saida = await jogoServico.lista();

            const data = {
                jogos: saida.jogos,
            };

            response.status(200).json(data);
        } catch (error) {
            console.error("Erro ao listar jogos:", error);
            response.status(500).json({ error: 'Erro ao listar jogos' });
        }
    }

    ...
</details>

## Express

## GOF XXXX
<!-- Tem que ver qual gof aplicamos de fato -->

<!-- TODO quem escrever primeiro -->
## Referências

[1] Arquitetura e Desenho de Software - Vídeo Aulas (Tópico 3 - Arquitetura de Software & Reutilização de Software). SERRANO, Milene.

[2] Arquitetura e Desenho de Software - Material em slide (Tópico 3 - Arquitetura de Software & Reutilização de Software). SERRANO, Milene.

[3] PRISMA. Prisma - Documentação. Disponível em: <https://www.prisma.io/>. Acesso em: 16 ago. 2024.

[4] UNIVERSIDADE FEDERAL DE SANTA MARIA. ORM - Object-Relational Mapping. Disponível em: <https://www.ufsm.br/pet/sistemas-de-informacao/2022/05/23/orm>. Acesso em: 16 ago. 2024.

[6] SOLID + MVC: Projeto completo com NodeJS, Typescript, Express e Prisma. Disponível em: <https://www.youtube.com/watch?v=RY0BQV803UU&t=647s>. Acesso em: 16 ago. 2024.

## Histórico de versão

| Data       | Versão | Atividade                                                | Responsável                                        |
| ---------- | ------ | -------------------------------------------------------- | -------------------------------------------------- |
| 15/08/2024 | 1.0    | Criação do documento e adição de exemplo de reutilização | [Luciano Ricardo](https://github.com/l-ricardo)    |
| 15/08/2024 | 2.0    | Adição do texto inicial do Tailwind                      | [Pedro Cabeceira](https://github.com/pkbceira03)   |
| 16/08/2024 | 3.0    | Adição do Prisma                                         | [Raquel Eucaria](https://github.com/raqueleucaria) |
